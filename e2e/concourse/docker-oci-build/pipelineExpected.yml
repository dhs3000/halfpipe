# Generated using halfpipe cli version 0.0.0-DEV
jobs:
- build_log_retention:
    minimum_succeeded_builds: 1
  name: push to docker registry
  plan:
  - attempts: 2
    get: git
    timeout: 15m
    trigger: true
  - config:
      image_resource:
        source:
          repository: concourse/oci-build-task
        type: registry-image
      inputs:
      - name: git
      outputs:
      - name: image
      params:
        BUILD_ARG_ARTIFACTORY_PASSWORD: ((artifactory.password))
        BUILD_ARG_ARTIFACTORY_URL: ((artifactory.url))
        BUILD_ARG_ARTIFACTORY_USERNAME: ((artifactory.username))
        BUILD_ARG_RUNNING_IN_CI: "true"
        CONTEXT: git/e2e/concourse/docker-oci-build
      platform: linux
      run:
        path: build
    privileged: true
    task: build
    timeout: 1h
  - params:
      image: image/image.tar
      version: 6.6.6
    put: halfpipe-fly.thisismy-tag
    timeout: 1h
  serial: true
resources:
- check_every: 10m
  name: git
  source:
    branch: main
    paths:
    - e2e/concourse/docker-oci-build
    private_key: ((halfpipe-github.private_key))
    uri: git@github.com:springernature/halfpipe.git
  type: git
- check_every: 24h
  name: halfpipe-fly.thisismy-tag
  source:
    password: verysecret
    repository: springerplatformengineering/halfpipe_fly:thisIsMy_Tag
    username: rob
  type: registry-image
